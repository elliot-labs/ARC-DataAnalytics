<!DOCTYPE html>
<html class="mdc-typography">
    <head>
        <!-- Document properties -->
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width,initial-scale=1">
        <!-- Title and description -->
        <title>Modern Design Note Maker</title>
        <meta name="description" content="The Note Maker redesigned for a modern computing environment.">
        <!-- Search keywords -->
        <meta name="keywords" content="HTML, CSS, JavaScript, Material Design, Modern, Note, Maker, Note Maker, Ticket, Ticket Maker">
        <!-- Credits -->
        <meta name="author" content="Elliot Huffman, Elliot.Huffman@unisys.com">
        <!-- Google Chrome for Android settings -->
        <meta name="theme-color" content="#5e35b1">
        <meta name="mobile-web-app-capable" content="yes">
        <!-- Safari for IOS settings -->
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
        <!-- Load the CSS framework and Icons -->
        <link rel="stylesheet" href="css/material-icons.css">
        <link rel="stylesheet" href="css/material-components-web.min.css">
        <!-- Custom CSS styles -->
        <style>

            /* Define the default theme colors */
            :root {
                --mdc-theme-primary: #5e35b1;
                --mdc-theme-secondary: #64dd17;
            }

            /* Set the background properties of the NoteMaker */
            .notemaker-body {
                padding: 0;
                margin: 0;
                line-height: 18.4px;
                box-sizing: border-box;
                margin-left: 16px;
                background-color: rgba(0, 0, 0, .02);
            }

            /* Ensures that the menu button background is transparent */
            .menu-button {
                background-color: rgba(0, 0, 0, 0);
            }

            /* set up the NoteMaker background canvas and canvas properties */
            .notemaker-main {
                padding-left: 16px;
                margin-left: 16px;
                overflow: auto;
                display: block;
            }

            /* Make the floating action button float on the bottom right corner */
            .app-fab--absolute.app-fab--absolute {
                position: fixed;
                bottom: 1rem;
                right: 1rem;
                z-index: 2;
            }

            /* Make the reset note maker button float above the new window button. */
            .mdc-fab--mini {
                position: fixed;
                bottom: 5.5rem;
                right: 1.5rem;
                z-index: 2;
            }

            /* Add padding to the right of text fields */
            .mdc-textfield {
                margin-right: 12px;
            }

            /* Ensure that the text field label background is transparent. */
            .mdc-textfield--textarea .mdc-textfield__label {
                background-color: transparent;
            }

            /* Remove the clear field "x" button from the input fields. MS IE adds this html to input fields. */
            .mdc-textfield__input::-ms-clear {
                display: none;
            }

            /* Add padding to the Cards and make sure that they do not get too big and hog the screen. Make the background white. */
            .mdc-card {
                margin-top: 1em;
                margin-bottom: .5em;
                margin-right: 1em;
                background: #fff;
                overflow-x: auto;
                max-width: 200px;
            }

            /* Make the cards and FABs responsive. */
            @media(min-width: 1024px) {
                .mdc-card {
                    max-width: 400px;
                }
                .app-fab--absolute.app-fab--absolute {
                    bottom: 1.5rem;
                    right: 1.5rem;
                }
                .mdc-fab--mini {
                    bottom: 6rem;
                    right: 2rem;
                }
            }
        </style>
    </head>

    <body class="mdc-typography notemaker-body" onload="initInterface()">

        <!-- Toolbar -->
        <div class="mdc-toolbar mdc-toolbar--waterfall mdc-toolbar--fixed">
            <div class="mdc-toolbar__row">
                <section class="mdc-toolbar__section mdc-toolbar__section--align-start">
                    <button class="menu-button material-icons mdc-toolbar__icon--menu" onclick="openNavDrawer()">menu</button>
                    <span class="mdc-toolbar__title catalog-title" id="toolbarText">Modern Design Note Maker</span>
                </section>
            </div>
        </div>

        <!-- Navigation Drawer -->
        <aside class="mdc-temporary-drawer mdc-typography">
            <nav class="mdc-temporary-drawer__drawer">
                <header class="mdc-temporary-drawer__header">
                    <div class="mdc-temporary-drawer__header-content mdc-theme--primary-bg mdc-theme--text-primary-on-primary">
                        Created by:<br>Elliot Huffman<br>Elliot.Huffman@Unisys.com<br>Version: Alpha 2
                    </div>
                </header>
                <nav class="mdc-temporary-drawer__content mdc-list-group">
                    <div class="mdc-list">
                        <a class="mdc-list-item mdc-temporary-drawer--selected" style="cursor: pointer">
                            <i class="material-icons mdc-list-item__start-detail" aria-hidden="true">description</i>Note Maker
                        </a>
                        <a class="mdc-list-item" onclick="exportCSV()" style="cursor: pointer">
                            <i class="material-icons mdc-list-item__start-detail" aria-hidden="true">file_download</i>Export (as CSV)
                        </a>
                        <a class="mdc-list-item" target="_blank" href="https://unisyscorp-my.sharepoint.com/personal/elliot_huffman_unisys_com/_layouts/15/guestaccess.aspx?guestaccesstoken=%2b8A4rBKLQy0YDv3gEUdWBiKeALn7Tcb6WggVbAuQuuY%3d&folderid=2_005c5cf9e6c884c948be46f7ca0b43bd3&rev=1">
                            <i class="material-icons mdc-list-item__start-detail" aria-hidden="true">apps</i>Other Apps
                        </a>
                    </div>

                    <hr class="mdc-list-divider">

                    <div id="nav-main" class="mdc-list">
                    </div>
                </nav>
            </nav>
        </aside>

        <!-- Message Box -->
        <aside id="MessageBox" class="mdc-dialog" role="alertdialog" aria-labelledby="MessageBox-label"
            aria-describedby="MessageBox-description">
            <div class="mdc-dialog__surface" id="MessageBox-Surface">
                <header class="mdc-dialog__header">
                    <h2 id="MessageBox-title" class="mdc-dialog__header__title">
                        Title Here
                    </h2>
                </header>
                <section id="MessageBox-description" class="mdc-dialog__body">
                    Long form text here...
                </section>
                <footer class="mdc-dialog__footer">
                    <button type="button" id="MessageBox-CancelButton" class="mdc-button mdc-dialog__footer__button mdc-dialog__footer__button--cancel">Cancel</button>
                    <button type="button" id="MessageBox-OKButton" class="mdc-button mdc-dialog__footer__button mdc-dialog__footer__button--accept">OK</button>
                </footer>
            </div>
            <div class="mdc-dialog__backdrop"></div>
        </aside>

        <!-- Main content -->
        <main id="main" class="notemaker-main mdc-toolbar-fixed-adjust" data-mdc-auto-init="MDCRipple">

            <!-- Javascript not available text -->
            <div class="mdc-typography--headline" id="Javascript-Notice" style="text-align:center">Javascript is required for the operation of this tool. Please enable it.</div>

            <!-- Floating Action Buttons (FAB) -->
            <button class="fab-new mdc-fab app-fab--absolute material-icons" aria-label="New Note Maker" onclick="newNoteMakerInstance()"
                data-mdc-auto-init="MDCRipple">
                <span class="mdc-fab__icon">
                    library_add
                </span>
            </button>
            <button class="mdc-fab mdc-fab--mini material-icons" aria-label="Reset Note Maker" data-mdc-auto-init="MDCRipple" onclick="resetNoteMakerPrompt()">
                <span class="mdc-fab__icon">
                    restore_page
                </span>
            </button>

            <!-- Form Selection Buttons -->
            <section id="Troubleshooting-Selector"></section>

            <!-- Input Section -->
            <form id="Troubleshooting-Input" action="#"></form>

            <!-- Spacing in between the input and the output sections -->
            <br>

            <!-- Output Cards -->
            <section id="Troubleshooting-Output">
                <div class="mdc-card__horizontal-block" id="Output-Card-Row"></div>
            </section>

        </main>

        <!-- Scripts -->
        <script src="js/material-components-web.min.js"></script>
        <script>
            // Init the fields and MDC system
            mdc.autoInit();

            // Remove Javascript warning (javascript is running so logically, you do nto need it any more.)
            document.getElementById("Javascript-Notice").outerHTML = "";
            
            // Ask if the user is sure before navigating away from the page
            // after the user has entered data into any of the fields.
            window.onbeforeunload = function() {
                // Create an array of text field input elements and create a local variable for accounting.
                var formFields =  document.getElementsByClassName("mdc-textfield__input");
                var dataPresent = false;
                // Loop through all of the elements in the array and if there is any data in them, set the variable to true.
                for (var index = 0; index < formFields.length; index++) {
                    if (formFields[index].value !== "") {
                        dataPresent = true;
                    }
                }
                if (dataPresent) {
                    if (browserPromptReset) {
                        return "You have made notes in the Note Maker, are you sure you want to leave?";
                    }                    
                }
            };

            // A function that loops, used for the waterfall animation on the toolbar.
            (function () {
                var pollId = 0;
                pollId = setInterval(function () {
                    var pos = getComputedStyle(document.querySelector('.mdc-toolbar')).position;
                    if (pos === 'fixed' || pos === 'relative') {
                        init();
                        clearInterval(pollId);
                    }
                }, 250);
                function init() {
                    var toolbar = mdc.toolbar.MDCToolbar.attachTo(document.querySelector('.mdc-toolbar'));
                    toolbar.fixedAdjustElement = document.querySelector('.mdc-toolbar-fixed-adjust');
                }
            })();

            // Create a HTTP put request to send to a server.
            function HTTPPost() {
                this.url = "https://www.example.com";
                this.content = "post body here";
                this.ContentType = "application/x-www-form-urlencoded";
                this.requestInstance = new XMLHttpRequest();

                this.Send = function() {
                    this.requestInstance.open("POST", this.url, true);
                    this.requestInstance.setRequestHeader("Content-Type", this.ContentType);
                    this.requestInstance.send(this.content);
                    return this.requestInstance.status;
                }
            }

            // Create a message box (dialog box) class for reuseable code.
            function MessageBox() {
                this.TitleText = "Title Here";
                this.DescriptionText = "Long Form Description Here...";
                this.OKButtonText = "OK!";
                this.CancelButtonText = "Cancel";
                this.RemoveCancelButton = false;
                this.RemoveOKButton = false;
                this.ErrorMode = false;
                this.LockoutMode = false;
                this.Duration = 0;
                this.ListenOK = ["", []];
                this.ListenCancel = ["", []];

                // Set the DOM vars for easy access
                this.MSGBox = document.getElementById("MessageBox");
                this.MSGBoxSurface = document.getElementById("MessageBox-Surface");
                this.MSGBoxTitle = document.getElementById("MessageBox-title");
                this.MSGBoxDescription = document.getElementById("MessageBox-description");
                this.MSGBoxOKBtn = document.getElementById("MessageBox-OKButton");
                this.MSGBoxCancelBtn = document.getElementById("MessageBox-CancelButton");

                // Shows the message box when called
                this.Show = function() {

                    // Remove the current event listener so that the old button function does not conflict with the current button function.
                    messageBox.unlisten("MDCDialog:accept", messageBoxOKFunction);
                    messageBox.unlisten("MDCDialog:cancel", messageBoxCancelFunction);

                    // define the function using the pre-defined string
                    var ok = window[this.ListenOK[0]];
                    var cancel = window[this.ListenCancel[0]];
                    
                    // if oKfn is indeed a function, execute it with the specified parameters.
                    if (typeof ok === "function") {

                        // Set the parameters as a global setting as after the even listener is created, it can't pull the params from inside another scope.
                        OKParams = this.ListenOK[1];

                        // Store the event listener as global so that conflicts do not occur.
                        messageBoxOKFunction = function() {
                            ok.apply(null, OKParams);
                        }

                        // Apply the function to the OK button's event so that it is executed when clicked.
                        messageBox.listen('MDCDialog:accept', messageBoxOKFunction);
                    }                    

                    // if cancel is indeed a function, execute it with the specified parameters.
                    if (typeof cancel === "function") {

                        // Set the parameters as a global setting as after the even listener is created, it can't pull the params from inside another scope.
                        CancelParams = this.ListenCancel[1];

                        // Store the event listener as global so that conflicts do not occur.
                        messageBoxCancelFunction = function() {
                            cancel.apply(null, CancelParams);
                        }
                        
                        // Apply the function to the cancel button's event so that it is executed when clicked.
                        messageBox.listen('MDCDialog:cancel', messageBoxCancelFunction);
                    }

                    // Verify if a dialog box is already open, if there is one open, close it.
                    var iSoPEN = document.getElementsByClassName('mdc-dialog--open mdc-dialog--animating');
                    if (iSoPEN.length > 0) {
                        messageBox.close();
                    }

                    // Set the text on the to the text specified
                    this.MSGBoxTitle.innerHTML = this.TitleText;
                    this.MSGBoxDescription.innerHTML = this.DescriptionText;
                    this.MSGBoxOKBtn.innerHTML = this.OKButtonText;
                    this.MSGBoxCancelBtn.innerHTML = this.CancelButtonText;

                    // Style the message box in a red color if the ErrorMode property is true.
                    // Otherwise, set the visuals to the default settings.
                    if (this.ErrorMode) {
                        this.MSGBoxSurface.style.backgroundColor = "red";
                        this.MSGBoxSurface.style.color = "white";
                        this.MSGBoxDescription.style.color = "white";
                        this.MSGBoxOKBtn.style.color = "white";
                        this.MSGBoxOKBtn.style.backgroundColor = "rgba(0,0,0,.07)";
                        this.MSGBoxCancelBtn.style.color = "white";
                        this.MSGBoxCancelBtn.style.backgroundColor = "rgba(0,0,0,.07)";
                    } else {
                        this.MSGBoxSurface.style.backgroundColor = "";
                        this.MSGBoxSurface.style.color = "";
                        this.MSGBoxDescription.style.color = "";
                        this.MSGBoxOKBtn.style.color = "";
                        this.MSGBoxOKBtn.style.backgroundColor = "";
                        this.MSGBoxCancelBtn.style.color = "";
                        this.MSGBoxCancelBtn.style.backgroundColor = "";
                    }

                    // If the remove button property is enabled for the cancel button, remove it.
                    // Otherwise keep it visible
                    if (this.RemoveCancelButton) {
                        this.MSGBoxCancelBtn.style.display = "none";
                    } else {
                        this.MSGBoxCancelBtn.style.display = "";
                    }

                    // If the remove button property is enabled for the ok button, remove it.
                    // Otherwise keep it visible
                    if (this.RemoveOKButton) {
                        this.MSGBoxOKBtn.style.display = "none";
                    } else {
                        this.MSGBoxOKBtn.style.display = "";
                    }

                    // If the duration is not set at 0 then auto close the dialog box
                    if (this.Duration !== 0) {
                        setTimeout(this.Close, this.Duration);
                    }

                    // Create a non closeable dialog box
                    if (this.RemoveCancelButton && this.RemoveOKButton && this.LockoutMode) {
                        this.MSGBox.className += " mdc-dialog--open";
                        this.MSGBox.style.position = "fixed";
                    } else {
                        messageBox.show();
                    }
                }

                // Manually closes the message box safely when called
                this.Close = function() {

                    // Check if the dialog box is already open, if it is then close the command, otherwise
                    // log to console that it is already closed.
                    var iSoPEN = document.getElementsByClassName('mdc-dialog--open');
                    if (iSoPEN.length > 0) {
                        messageBox.close();
                    } else {
                        return false;
                    }
                }
            }

            // Create a section class to arrange elements horizontally and vertically in a reuseable fashion.
            function Section() {
                // Create the initial objects required for the configuration section manipulation.
                this.SectionObject = "";
                this.ButtonCompatible = false;
                this.HorizontalFlex = false;
                this.ParentID = "Troubleshooting-Input";
                this.SectionID = "";

                // Create the section and attach it to the parent section.
                this.Create = function() {
                    if (this.SectionObject === "") {
                            // Create the section element
                        var sectionObject = document.createElement("section");
                        // grab the parent, element's object to make useable
                        var parentElement = document.getElementById(this.ParentID);

                        // If no ID for this section is specified, do not add an ID.
                        if (this.SectionID !== "") {
                            // Add an ID to the created section
                            sectionObject.id = this.SectionID;
                        }
                        // If the button compatibility toggle is enabled, add 1 em padding to the bottom of the section
                        if (this.ButtonCompatible) {
                            sectionObject.style.paddingBottom = "1em";
                        }
                        if (this.HorizontalFlex) {
                            sectionObject.style.display = "flex";
                        }

                        // Add the element to another element
                        parentElement.appendChild(sectionObject);
                        // set the section object to be the result of the creation of the section
                        this.SectionObject = sectionObject;

                        // Return the section Object just incase it needs to be used somewhere else in a different fashion.
                        return sectionObject;    
                    } else {
                        return false;
                    }
                }

                // Remove the element if it exists
                this.Remove = function() {
                    // Check if the Object is blank and if it is, skip and return false
                    // Otherwise, remove the outer HTML reset the variable that contains the object and return true.
                    if (this.SectionObject !== "") {
                        this.SectionObject.outerHTML = "";
                        this.SectionObject = "";
                        return true;
                    } else {
                        return false;
                    }
                }
            }

            // Create a text field class for reuseable code.
            function TextField() {
                // Sets the initial settings for a new text field.
                this.TextFieldDivObject = "";
                this.TextFieldInputObject = "";
                this.Label = "Description of the textfield";
                this.ID = "text-field";
                this.ParentID = "Row 1";
                this.OnInput = "updateCards()";
                this.TextArea = false;
                this.TextAreaRows = "8";
                this.TextAreaColumns = "25";
                this.AutoComplete = false;
                this.SpellCheck = true;
                this.Required = false;

                // Creates a new input field with the specified values
                this.Create = function() {
                    if (this.TextFieldDivObject === "" && this.TextFieldInputObject === "") {
                            var divContainer = document.createElement("div");
                        if (this.TextArea) {
                            var textInput = document.createElement("textarea");
                            textInput.setAttribute("rows", this.TextAreaRows);
                            textInput.setAttribute("cols", this.TextAreaColumns);
                        } else {
                            var textInput = document.createElement("input");
                            textInput.setAttribute("type", "text");

                            var bottomLine = document.createElement("div");
                            bottomLine.className = "mdc-textfield__bottom-line";
                            bottomLine.style.transformOrigin = "99px center";
                        }
                        var textLabel = document.createElement("label");
                        var parentElement = document.getElementById(this.ParentID);

                        // DivContainer Section
                        divContainer.id = this.ID + "-div-container";
                        if (this.TextArea) {
                            divContainer.className = "mdc-textfield mdc-textfield--textarea";
                        } else {
                            divContainer.className = "mdc-textfield";
                        }

                        // Text Input section
                        textInput.id = this.ID;
                        textInput.className = "mdc-textfield__input";
                        textInput.setAttribute("name", this.ID);
                        if (this.SpellCheck) {
                            textInput.setAttribute("spellcheck", "true");
                        }
                        if (this.AutoComplete) {
                            textInput.setAttribute("autocomplete", "on");
                        } else {
                            textInput.setAttribute("autocomplete", "off");
                        }
                        if (this.Required) {
                            textInput.required = true;
                        }
                        if (this.OnInput !== "") {
                            textInput.setAttribute("oninput", this.OnInput);
                        }

                        // Text Label Section
                        textLabel.className = "mdc-textfield__label";
                        textLabel.setAttribute("for", this.ID);
                        textLabel.innerHTML = this.Label;

                        // Add from memory to HTML for rendering
                        parentElement.appendChild(divContainer);
                        divContainer.appendChild(textInput);
                        divContainer.appendChild(textLabel);
                        if (!this.TextArea) {
                            divContainer.appendChild(bottomLine);
                        }

                        // Update objects to be useable outside of method execution
                        this.TextFieldDivObject = divContainer;
                        this.TextFieldInputObject = textInput;

                        // Enable MDC integration for visuals
                        mdc.textfield.MDCTextfield.attachTo(document.getElementById(divContainer.id));

                        // Return the div container for other components if they use this
                        return divContainer;   
                    } else {
                        return false;
                    }
                }

                // Deletes the input field and cleans up the variables for a new creation of the object.
                this.Remove = function() {
                    if (this.TextFieldDivObject !== "") {
                        this.TextFieldDivObject.outerHTML = "";
                        this.TextFieldDivObject = "";
                        this.TextFieldInputObject = "";
                        return true;
                    } else {
                        return false;
                    }
                }

                // Returns the text in the input field.
                // Escapes characters so that user do not accidentally create HTML in the results.
                this.GetText = function() {
                    if (this.TextFieldDivObject !== "" && this.TextFieldInputObject !== "") {
                    return this.TextFieldInputObject.value.replace(/[&"<>]/g, function (c) {
                        return {
                            '&': "&amp;",
                            '"': "&quot;",
                            '<': "&lt;",
                            '>': "&gt;"
                        }[c];
                    });   
                    } else {
                        return false;
                    }
                }

                // Sets the text in the input field
                this.SetText = function(textParam) {
                    if (this.TextFieldDivObject !== "" && this.TextFieldInputObject !== "") {
                        this.TextFieldInputObject.value = textParam;   
                    } else {
                        return false;
                    }
                }
            }

            // Create a Text Card class for reuseable code.
            function TextCard() {
                // Set up the various properties that the user will configure after they instantiate the class.
                this.ParentID = "Output-Card-Row";
                this.ID = "OutputCard";
                this.CardAction = "";
                this.TitleText = "Title";
                this.SubtitleText = "Subtitle";
                this.RemoveSubtitleText = false;
                this.BodyText = "Body Text";
                this.RemoveButton1 = false;
                this.RemoveButton2 = false;
                this.Button1Text = "Button 1";
                this.Button2Text = "Button 2";
                this.Button1Action = "";
                this.Button2Action = "";
                this.CardObject = "";
                this.BodyObject = "";

                // Create the actual card for display on screen.
                // Depending on how the properties are configured, the user may even be able to interact with the card.
                this.Create = function() {
                    // Create the variables needed for the operation of this method
                    var parentElement = document.getElementById(this.ParentID);
                    var cardContainer = document.createElement("div");
                    var headerSection = document.createElement("section");
                    var titleElement = document.createElement("h1");
                    var subtitleElement = document.createElement("h2");
                    var bodySection = document.createElement("section");
                    var footerSection = document.createElement("section");
                    var button1 = document.createElement("button");
                    var button2 = document.createElement("button");

                    // Set the classes of the various components that are created.
                    cardContainer.className = "mdc-card";
                    headerSection.className = "mdc-card__primary";
                    titleElement.className = "mdc-card__title mdc-card__title--large";
                    subtitleElement.className = "mdc-card__subtitle";
                    bodySection.className = "mdc-card__supporting-text";
                    footerSection.className = "mdc-card__actions";
                    button1.className = "mdc-button mdc-button--compact mdc-card__action";
                    button2.className = "mdc-button mdc-button--compact mdc-card__action";

                    // Set the ID of the body text section so that it can be interacted with in the future.
                    bodySection.id = this.ID;

                    // Remove sections if they are disabled by the user.
                    if (this.RemoveSubtitleText) {
                        subtitleElement.style.display = "none";
                    }
                    if (this.RemoveButton1) {
                        button1.style.display = "none";                        
                    }
                    if (this.RemoveButton2) {
                        button2.style.display = "none";
                    }

                    // Set the text of the elements
                    titleElement.innerHTML = this.TitleText;
                    subtitleElement.innerHTML = this.SubtitleText;
                    bodySection.innerHTML = this.BodyText;
                    button1.innerHTML = this.Button1Text;
                    button2.innerHTML = this.Button2Text;

                    // Set the event listeners for the various interactive components of the card. Including the card itself,
                    // if the buttons are not assigned an event listener too.
                    if (this.CardAction !== "" && this.Button1Action === "" && this.Button1Action === "") {
                        cardContainer.setAttribute("onclick", this.CardAction);
                    } else {
                        if (this.Button1Action !== "") {
                            button1.setAttribute("onclick", this.Button1Action);
                        }
                        if (this.Button2Action !== "") {
                            button2.setAttribute("onclick", this.Button1Action);
                        }
                    }

                    // Add the actual HTML from memory to the web page for rendering and use by the user.
                    parentElement.appendChild(cardContainer);
                    cardContainer.appendChild(headerSection);
                    headerSection.appendChild(titleElement);
                    headerSection.appendChild(subtitleElement);
                    cardContainer.appendChild(bodySection);
                    cardContainer.appendChild(footerSection);
                    footerSection.appendChild(button1);
                    footerSection.appendChild(button2);

                    // Alter the property to reflect the proper object.
                    this.CardObject = cardContainer;
                    this.BodyObject = bodySection;

                    // Return the card container for use by other programs incase they need access to the object.
                    return cardContainer;
                }

                // Removes the card from the page.
                this.Remove = function() {
                    // Remove the card object only if the card object has been crated.
                    // Then reset the stored objects so that they can be reused.
                    if (this.CardObject !== "") {
                        this.CardObject.outerHTML = "";  
                        this.CardObject = "";
                        this.BodyObject = "";

                        // Return true after the card has been removed.
                        return true;
                    }
                }

                // Update the text displayed on the card.
                this.UpdateText = function(textContent) {
                    if (this.BodyObject !== "") {
                        this.BodyObject.innerHTML = textContent;
                    }
                }
            }

            // Create a Button class for reuseable code.
            function Button() {
                // Set up the various properties that the user will configure after they instantiate the class.
                this.ParentID = "Row 1";
                this.Text = "Button";
                this.AccentColor = false;
                this.AutoMargin = true;
                this.ButtonAction = "";
                this.ButtonObject = "";

                // Create the actual button for display on screen.
                this.Create = function() {
                    if (this.ButtonObject === "") {
                        var parentElement = document.getElementById(this.ParentID);
                        var buttonObject = document.createElement("button");

                        // Configure the button.
                        buttonObject.className = "mdc-button mdc-button--raised";
                        if (this.AccentColor) {
                            buttonObject.className += " mdc-button--accent"
                        }
                        if (this.AutoMargin) {
                            buttonObject.style.margin = "auto";
                        }
                        if (this.ButtonAction !== "") {
                            buttonObject.setAttribute("onclick", this.ButtonAction);
                        }
                        buttonObject.innerHTML = this.Text;

                        // Add the actual HTML from memory to the web page for rendering and use by the user.
                        parentElement.appendChild(buttonObject);

                        // Alter the property to reflect the proper object.
                        this.ButtonObject = buttonObject;

                        // Return the button object for use by other programs incase they need access to the object.
                        return buttonObject;   
                    } else {
                        return false;
                    }
                }

                // Deletes the button and cleans up the variables for a new creation of the object.
                this.Remove = function() {
                    if (this.ButtonObject !== "") {
                        this.ButtonObject.outerHTML = "";
                        this.ButtonObject = "";
                        return true;
                    } else {
                        return false;
                    }
                }
            }

            // Create a Menu Item class for reuseable code.
            function MenuItem() {
                // Set up the various properties that the user will configure after they instantiate the class.
                this.ParentID = "nav-main";
                this.MenuItemText = "Menu Item";
                this.Icon = "receipt";
                this.ItemAction = "loadTemplate(9999)";
                this.ItemObject = "";

                // Create the actual menu item for display on screen.
                this.Create = function() {
                    if (this.ItemObject === "") {
                        var parentElement = document.getElementById(this.ParentID);
                        var menuLink = document.createElement("a");
                        var menuIcon = document.createElement("i");

                        menuLink.style.cursor = "pointer";
                        menuLink.setAttribute("onclick", this.ItemAction);
                        menuLink.className = "mdc-list-item";

                        menuIcon.innerHTML = this.Icon;
                        menuIcon.className = "material-icons mdc-list-item__start-detail";
                        menuIcon.setAttribute("aria-hidden", "true");

                        parentElement.appendChild(menuLink);
                        menuLink.innerHTML = menuIcon.outerHTML + this.MenuItemText;

                        this.ItemObject = menuLink;
                        return menuLink;                        
                    } else {
                        return false;
                    }
                }
                
                // Deletes the menu item and cleans up the variables for a new creation of the object.
                this.Remove = function() {
                    if (this.ItemObject !== "") {
                        this.ItemObject.outerHTML = "";
                        this.ItemObject = "";
                        return true;
                    } else {
                        return false;
                    }
                }
            }

            // Global variables that are set for all functions to access.
            var drawer = new mdc.drawer.MDCTemporaryDrawer(document.querySelector('.mdc-temporary-drawer'));
            var messageBox = new mdc.dialog.MDCDialog(document.querySelector('#MessageBox'));
            var browserPromptReset = true;
            var messageBoxOKFunction = null;
            var messageBoxCancelFunction = null;
            var selectedUI = null;

            // Initial Interface
            function initInterface() {
                // if the system has multiple UIs, define the current UI
                selectedUI = "Init";
                // Change the title text
                document.getElementById("toolbarText").innerHTML = "Note Maker - Main Menu";

                // Create a row
                buttonRow = new Section();
                buttonRow.ParentID = "main";
                buttonRow.ButtonCompatible = true;
                buttonRow.HorizontalFlex = true;
                buttonRow.SectionID = "Center Row";
                buttonRow.Create();

                // Create a button
                button = new Button();
                button.ParentID = "Center Row";
                button.Text = "Flowserve";
                button.ButtonAction = "flowserveUI()";
                button.Create();

                // Create a button
                button2 = new Button();
                button2.ParentID = "Center Row";
                button2.Text = "Moët Hennessy";
                button2.ButtonAction = "moëtHennessyUI()";
                button2.Create();

                // Create a button
                button3 = new Button();
                button3.ParentID = "Center Row";
                button3.Text = "Texas Workforce Commission";
                button3.ButtonAction = "texasWorkforceUI()";
                button3.Create();

                // Create a button
                button4 = new Button();
                button4.ParentID = "Center Row";
                button4.Text = "City of Chicago";
                button4.ButtonAction = "cityOfChicagoUI()";
                button4.Create();
            }

            // Flowserve
            function flowserveUI() {
                // if the system has multiple UIs, define the current UI
                selectedUI = "Flowserve";
                // Change the title text
                document.getElementById("toolbarText").innerHTML = "Note Maker - Flowserve";

                // Remove the previous UI
                button.Remove();
                button2.Remove();
                button3.Remove();
                button4.Remove();
                buttonRow.Remove();

                // Create menu item
                bitlockerKeyMenuItem = new MenuItem();
                bitlockerKeyMenuItem.MenuItemText = "BitLocker Key";
                bitlockerKeyMenuItem.Icon = "vpn_key";
                bitlockerKeyMenuItem.ItemAction = "loadTemplate(0001)";
                bitlockerKeyMenuItem.Create();
                
                // Create menu item
                accountUnlockMenuItem = new MenuItem();
                accountUnlockMenuItem.MenuItemText = "Account Unlock";
                accountUnlockMenuItem.Icon = "lock_open";
                accountUnlockMenuItem.ItemAction = "loadTemplate(0002)";
                accountUnlockMenuItem.Create();
                
                // Create menu item
                passwordResetMenuItem = new MenuItem();
                passwordResetMenuItem.MenuItemText = "Password Reset";
                passwordResetMenuItem.Icon = "account_circle";
                passwordResetMenuItem.ItemAction = "loadTemplate(0003)";
                passwordResetMenuItem.Create();

                // Create row
                row1 = new Section();
                row1.SectionID = "Row 1";
                row1.Create();

                // Create row
                row2 = new Section();
                row2.SectionID = "Row 2";
                row2.Create();

                // Create row
                row3 = new Section();
                row3.SectionID = "Row 3";
                row3.Create();

                // Create row
                row4 = new Section();
                row4.SectionID = "Row 4";
                row4.Create();

                // Create row
                row5 = new Section();
                row5.SectionID = "Row 5";
                row5.Create();

                // Create a text field
                nameField = new TextField();
                nameField.Label = "Name";
                nameField.ID = "Name-Field";
                nameField.ParentID = "Row 1";
                nameField.SpellCheck = false;
                nameField.Required = true;
                nameField.Create();

                // Create a text field
                phoneNumberField = new TextField();
                phoneNumberField.Label = "Phone Number";
                phoneNumberField.ID = "Phone-Number-Field";
                phoneNumberField.ParentID = "Row 1";
                phoneNumberField.SpellCheck = false;
                phoneNumberField.Required = true;
                phoneNumberField.Create();

                // Create a text field
                workHoursField = new TextField();
                workHoursField.Label = "Work Hours";
                workHoursField.ID = "Work-Hours-Field";
                workHoursField.ParentID = "Row 1";
                workHoursField.SpellCheck = false;
                workHoursField.Required = true;
                workHoursField.Create();

                // Create a text field
                assetTagField = new TextField();
                assetTagField.Label = "Asset Tag";
                assetTagField.ID = "Asset-Tag-Field";
                assetTagField.ParentID = "Row 2";
                assetTagField.SpellCheck = false;
                assetTagField.Required = true;
                assetTagField.Create();

                // Create a text field
                formFactorField = new TextField();
                formFactorField.Label = "Desktop/Laptop";
                formFactorField.ID = "Form-Factor-Field";
                formFactorField.ParentID = "Row 2";
                formFactorField.SpellCheck = false;
                formFactorField.Required = true;
                formFactorField.Create();

                // Create a text field
                locationField = new TextField();
                locationField.Label = "Location";
                locationField.ID = "Location-Field";
                locationField.ParentID = "Row 3";
                locationField.SpellCheck = false;
                locationField.Required = true;
                locationField.Create();

                // Create a text field
                gemsIDField = new TextField();
                gemsIDField.Label = "GEMS ID";
                gemsIDField.ID = "GEMS-ID-Field";
                gemsIDField.ParentID = "Row 3";
                gemsIDField.SpellCheck = false;
                gemsIDField.Required = true;
                gemsIDField.Create();

                // Create a text field
                problemField = new TextField();
                problemField.Label = "Problem (Symptom)";
                problemField.ID = "Problem-Field";
                problemField.ParentID = "Row 3";
                problemField.AutoComplete = true;
                problemField.Required = true;
                problemField.Create();

                // Create a text field
                actionsField = new TextField();
                actionsField.Label = "Actions";
                actionsField.TextArea = true;
                actionsField.TextAreaColumns = "50";
                actionsField.ID = "Actions-Field";
                actionsField.ParentID = "Row 4";
                actionsField.AutoComplete = true;
                actionsField.Required = true;
                actionsField.Create();

                // Create a text field
                helpFilesField = new TextField();
                helpFilesField.Label = "Help File(s) Used";
                helpFilesField.TextArea = true;
                helpFilesField.ID = "Help-File-Field";
                helpFilesField.ParentID = "Row 4";
                helpFilesField.SpellCheck = false;
                helpFilesField.Required = true;
                helpFilesField.Create();

                // Create a text field
                agentNotesField = new TextField();
                agentNotesField.Label = "Misc. Notes, Will not be saved!";
                agentNotesField.TextArea = true;
                agentNotesField.ID = "Agent-Notes-Field";
                agentNotesField.ParentID = "Row 4";
                agentNotesField.Create();

                // Create a text field
                resolutionField = new TextField();
                resolutionField.Label = "Resolution";
                resolutionField.ID = "Resolution-Field";
                resolutionField.ParentID = "Row 5";
                resolutionField.Required = true;
                resolutionField.Create();

                // Create a text card
                shortDescriptionCard = new TextCard();
                shortDescriptionCard.ID = "Short-Description-Card";
                shortDescriptionCard.TitleText = "(Short) Description";
                shortDescriptionCard.RemoveSubtitleText = true;
                shortDescriptionCard.BodyText = "This content goes in the \"Short Description\" field in SNOW";
                shortDescriptionCard.RemoveButton2 = true;
                shortDescriptionCard.Button1Text = "Copy";
                shortDescriptionCard.CardAction = "copyByElementID(\"Short-Description-Card\", true)";
                shortDescriptionCard.Create();

                // Create a text card
                workNotesCard = new TextCard();
                workNotesCard.ID = "Work-Notes-Card";
                workNotesCard.TitleText = "Work Notes";
                workNotesCard.RemoveSubtitleText = true;
                workNotesCard.BodyText = "This content goes in the \"Work notes\" field in SNOW";
                workNotesCard.RemoveButton2 = true;
                workNotesCard.Button1Text = "Copy";
                workNotesCard.CardAction = "copyByElementID(\"Work-Notes-Card\", true)";
                workNotesCard.Create();

                // Create a text card
                assignmentGroupCard = new TextCard();
                assignmentGroupCard.ID = "Assignment-Group-Card";
                assignmentGroupCard.TitleText = "Assignment Group";
                assignmentGroupCard.RemoveSubtitleText = true;
                assignmentGroupCard.BodyText = "Service Desk-NA-ROC-FLS";
                assignmentGroupCard.RemoveButton2 = true;
                assignmentGroupCard.Button1Text = "Copy";
                assignmentGroupCard.CardAction = "copyByElementID(\"Assignment-Group-Card\")";
                assignmentGroupCard.Create();
            }

            // Moët Hennessy
            function moëtHennessyUI() {
                // if the system has multiple UIs, define the current UI
                selectedUI = "Moët Hennessy";
                // Change the title text
                document.getElementById("toolbarText").innerHTML = "Note Maker - Moët Hennessy";

                // Remove the previous UI
                button.Remove();
                button2.Remove();
                button3.Remove();
                button4.Remove();
                buttonRow.Remove();

                // Create a menu item
                bitlockerKeyMenuItem = new MenuItem();
                bitlockerKeyMenuItem.MenuItemText = "BitLocker Key";
                bitlockerKeyMenuItem.Icon = "vpn_key";
                bitlockerKeyMenuItem.ItemAction = "loadTemplate(0011)";
                bitlockerKeyMenuItem.Create();

                // Create a menu item
                accountUnlockMenuItem = new MenuItem();
                accountUnlockMenuItem.MenuItemText = "Account Unlock";
                accountUnlockMenuItem.Icon = "lock_open";
                accountUnlockMenuItem.ItemAction = "loadTemplate(0012)";
                accountUnlockMenuItem.Create();

                // Create a menu item
                passwordResetMenuItem = new MenuItem();
                passwordResetMenuItem.MenuItemText = "Password Reset";
                passwordResetMenuItem.Icon = "account_circle";
                passwordResetMenuItem.ItemAction = "loadTemplate(0013)";
                passwordResetMenuItem.Create();

                // Create a row
                row1 = new Section();
                row1.SectionID = "Row 1";
                row1.Create();

                // Create a row
                row2 = new Section();
                row2.SectionID = "Row 2";
                row2.Create();

                // Create a row
                row3 = new Section();
                row3.SectionID = "Row 3";
                row3.Create();

                // Create a row
                row4 = new Section();
                row4.SectionID = "Row 4";
                row4.Create();

                // Create a row
                row5 = new Section();
                row5.SectionID = "Row 5";
                row5.Create();

                // Create a field
                nameField = new TextField();
                nameField.Label = "Name";
                nameField.ID = "Name-Field";
                nameField.ParentID = "Row 1";
                nameField.SpellCheck = false;
                nameField.Required = true;
                nameField.Create();

                // Create a field
                phoneNumberField = new TextField();
                phoneNumberField.Label = "Phone Number";
                phoneNumberField.ID = "Phone-Number-Field";
                phoneNumberField.ParentID = "Row 1";
                phoneNumberField.SpellCheck = false;
                phoneNumberField.Required = true;
                phoneNumberField.Create();

                // Create a field
                workHoursField = new TextField();
                workHoursField.Label = "Work Hours";
                workHoursField.ID = "Work-Hours-Field";
                workHoursField.ParentID = "Row 1";
                workHoursField.SpellCheck = false;
                workHoursField.Required = true;
                workHoursField.Create();

                // Create a field
                formFactorField = new TextField();
                formFactorField.Label = "Desktop/Laptop";
                formFactorField.ID = "Form-Factor-Field";
                formFactorField.ParentID = "Row 2";
                formFactorField.SpellCheck = false;
                formFactorField.Required = true;
                formFactorField.Create();

                // Create a field
                locationField = new TextField();
                locationField.Label = "Location";
                locationField.ID = "Location-Field";
                locationField.ParentID = "Row 2";
                locationField.SpellCheck = false;
                locationField.Required = true;
                locationField.Create();

                // Create a field
                problemField = new TextField();
                problemField.Label = "Problem (Symptom)";
                problemField.ID = "Problem-Field";
                problemField.ParentID = "Row 3";
                problemField.AutoComplete = true;
                problemField.Required = true;
                problemField.Create();

                // Create a field
                actionsField = new TextField();
                actionsField.Label = "Actions";
                actionsField.TextArea = true;
                actionsField.TextAreaColumns = "50";
                actionsField.ID = "Actions-Field";
                actionsField.ParentID = "Row 4";
                actionsField.AutoComplete = true;
                actionsField.Required = true;
                actionsField.Create();

                // Create a field
                helpFilesField = new TextField();
                helpFilesField.Label = "Help File(s) Used";
                helpFilesField.TextArea = true;
                helpFilesField.ID = "Help-File-Field";
                helpFilesField.ParentID = "Row 4";
                helpFilesField.SpellCheck = false;
                helpFilesField.Required = true;
                helpFilesField.Create();

                // Create a field
                agentNotesField = new TextField();
                agentNotesField.Label = "Misc. Notes, Will not be saved!";
                agentNotesField.TextArea = true;
                agentNotesField.ID = "Agent-Notes-Field";
                agentNotesField.ParentID = "Row 4";
                agentNotesField.Create();

                // Create a field
                resolutionField = new TextField();
                resolutionField.Label = "Resolution";
                resolutionField.ID = "Resolution-Field";
                resolutionField.ParentID = "Row 5";
                resolutionField.Required = true;
                resolutionField.Create();

                // Create a text card
                shortDescriptionCard = new TextCard();
                shortDescriptionCard.ID = "Short-Description-Card";
                shortDescriptionCard.TitleText = "(Short) Description";
                shortDescriptionCard.RemoveSubtitleText = true;
                shortDescriptionCard.BodyText = "This content goes in the \"Short Description\" field in SNOW";
                shortDescriptionCard.RemoveButton2 = true;
                shortDescriptionCard.Button1Text = "Copy";
                shortDescriptionCard.CardAction = "copyByElementID(\"Short-Description-Card\", true)";
                shortDescriptionCard.Create();

                // Create a text card
                workNotesCard = new TextCard();
                workNotesCard.ID = "Work-Notes-Card";
                workNotesCard.TitleText = "Work Notes";
                workNotesCard.RemoveSubtitleText = true;
                workNotesCard.BodyText = "This content goes in the \"Work notes\" field in SNOW";
                workNotesCard.RemoveButton2 = true;
                workNotesCard.Button1Text = "Copy";
                workNotesCard.CardAction = "copyByElementID(\"Work-Notes-Card\", true)";
                workNotesCard.Create();

                // Create a text card
                assignmentGroupCard = new TextCard();
                assignmentGroupCard.ID = "Assignment-Group-Card";
                assignmentGroupCard.TitleText = "Assignment Group";
                assignmentGroupCard.RemoveSubtitleText = true;
                assignmentGroupCard.BodyText = "WW-SD-ROC-ENG";
                assignmentGroupCard.RemoveButton2 = true;
                assignmentGroupCard.Button1Text = "Copy";
                assignmentGroupCard.CardAction = "copyByElementID(\"Assignment-Group-Card\")";
                assignmentGroupCard.Create();
            }

            // Texas Workforce Commission
            function texasWorkforceUI() {
                // if the system has multiple UIs, define the current UI
                selectedUI = "Texas Workforce Commission";
                // Change the title text
                document.getElementById("toolbarText").innerHTML = "Note Maker - Texas Workforce Commission";

                // Remove the previous UI
                button.Remove();
                button2.Remove();
                button3.Remove();
                button4.Remove();
                buttonRow.Remove();

                // Create a menu item
                bitlockerKeyMenuItem = new MenuItem();
                bitlockerKeyMenuItem.MenuItemText = "BitLocker Key";
                bitlockerKeyMenuItem.Icon = "vpn_key";
                bitlockerKeyMenuItem.ItemAction = "loadTemplate(0101)";
                bitlockerKeyMenuItem.Create();

                // Create a menu item
                accountUnlockMenuItem = new MenuItem();
                accountUnlockMenuItem.MenuItemText = "Account Unlock";
                accountUnlockMenuItem.Icon = "lock_open";
                accountUnlockMenuItem.ItemAction = "loadTemplate(0102)";
                accountUnlockMenuItem.Create();

                // Create a menu item
                passwordResetMenuItem = new MenuItem();
                passwordResetMenuItem.MenuItemText = "Password Reset";
                passwordResetMenuItem.Icon = "account_circle";
                passwordResetMenuItem.ItemAction = "loadTemplate(0103)";
                passwordResetMenuItem.Create();

                // Create a row
                row1 = new Section();
                row1.SectionID = "Row 1";
                row1.Create();

                // Create a row
                row2 = new Section();
                row2.SectionID = "Row 2";
                row2.Create();

                // Create a row
                row3 = new Section();
                row3.SectionID = "Row 3";
                row3.Create();

                // Create a row
                row4 = new Section();
                row4.SectionID = "Row 4";
                row4.Create();

                // Create a row
                row5 = new Section();
                row5.SectionID = "Row 5";
                row5.Create();

                // Create a text field
                nameField = new TextField();
                nameField.Label = "Name";
                nameField.ID = "Name-Field";
                nameField.ParentID = "Row 1";
                nameField.SpellCheck = false;
                nameField.Required = true;
                nameField.Create();

                // Create a text field
                phoneNumberField = new TextField();
                phoneNumberField.Label = "Phone Number";
                phoneNumberField.ID = "Phone-Number-Field";
                phoneNumberField.ParentID = "Row 1";
                phoneNumberField.SpellCheck = false;
                phoneNumberField.Required = true;
                phoneNumberField.Create();

                // Create a text field
                workHoursField = new TextField();
                workHoursField.Label = "Work Hours";
                workHoursField.ID = "Work-Hours-Field";
                workHoursField.ParentID = "Row 1";
                workHoursField.SpellCheck = false;
                workHoursField.Required = true;
                workHoursField.Create();

                // Create a text field
                assetTagField = new TextField();
                assetTagField.Label = "Asset Tag";
                assetTagField.ID = "Asset-Tag-Field";
                assetTagField.ParentID = "Row 2";
                assetTagField.SpellCheck = false;
                assetTagField.Required = true;
                assetTagField.Create();

                // Create a text field
                serialNumberField = new TextField();
                serialNumberField.Label = "Serial Number";
                serialNumberField.ID = "Serial-Number-Field";
                serialNumberField.ParentID = "Row 2";
                serialNumberField.SpellCheck = false;
                serialNumberField.Required = true;
                serialNumberField.Create();

                // Create a text field
                formFactorField = new TextField();
                formFactorField.Label = "Desktop/Laptop";
                formFactorField.ID = "Form-Factor-Field";
                formFactorField.ParentID = "Row 2";
                formFactorField.SpellCheck = false;
                formFactorField.Required = true;
                formFactorField.Create();

                // Create a text field
                locationField = new TextField();
                locationField.Label = "Location";
                locationField.ID = "Location-Field";
                locationField.ParentID = "Row 3";
                locationField.SpellCheck = false;
                locationField.Required = true;
                locationField.Create();

                // Create a text field
                pcRefreshField = new TextField();
                pcRefreshField.Label = "PC Refresh";
                pcRefreshField.ID = "PC-Refresh-Field";
                pcRefreshField.ParentID = "Row 2";
                pcRefreshField.SpellCheck = false;
                pcRefreshField.Required = true;
                pcRefreshField.Create();

                // Create a text field
                problemField = new TextField();
                problemField.Label = "Problem (Symptom)";
                problemField.ID = "Problem-Field";
                problemField.ParentID = "Row 3";
                problemField.AutoComplete = true;
                problemField.Required = true;
                problemField.Create();

                // Create a text field
                actionsField = new TextField();
                actionsField.Label = "Actions";
                actionsField.TextArea = true;
                actionsField.TextAreaColumns = "50";
                actionsField.ID = "Actions-Field";
                actionsField.ParentID = "Row 4";
                actionsField.AutoComplete = true;
                actionsField.Required = true;
                actionsField.Create();

                // Create a text field
                helpFilesField = new TextField();
                helpFilesField.Label = "Help File(s) Used";
                helpFilesField.TextArea = true;
                helpFilesField.ID = "Help-File-Field";
                helpFilesField.ParentID = "Row 4";
                helpFilesField.SpellCheck = false;
                helpFilesField.Required = true;
                helpFilesField.Create();

                // Create a text field
                agentNotesField = new TextField();
                agentNotesField.Label = "Misc. Notes, Will not be saved!";
                agentNotesField.TextArea = true;
                agentNotesField.ID = "Agent-Notes-Field";
                agentNotesField.ParentID = "Row 4";
                agentNotesField.Create();

                // Create a text field
                resolutionField = new TextField();
                resolutionField.Label = "Resolution";
                resolutionField.ID = "Resolution-Field";
                resolutionField.ParentID = "Row 5";
                resolutionField.Required = true;
                resolutionField.Create();

                // Create a text card
                shortDescriptionCard = new TextCard();
                shortDescriptionCard.ID = "Short-Description-Card";
                shortDescriptionCard.TitleText = "(Short) Description";
                shortDescriptionCard.RemoveSubtitleText = true;
                shortDescriptionCard.BodyText = "This content goes in the \"Short Description\" field in SNOW";
                shortDescriptionCard.RemoveButton2 = true;
                shortDescriptionCard.Button1Text = "Copy";
                shortDescriptionCard.CardAction = "copyByElementID(\"Short-Description-Card\", true)";
                shortDescriptionCard.Create();

                // Create a text card
                workNotesCard = new TextCard();
                workNotesCard.ID = "Work-Notes-Card";
                workNotesCard.TitleText = "Work Notes";
                workNotesCard.RemoveSubtitleText = true;
                workNotesCard.BodyText = "This content goes in the \"Work notes\" field in SNOW";
                workNotesCard.RemoveButton2 = true;
                workNotesCard.Button1Text = "Copy";
                workNotesCard.CardAction = "copyByElementID(\"Work-Notes-Card\", true)";
                workNotesCard.Create();

                // Create a text card
                assignmentGroupCard = new TextCard();
                assignmentGroupCard.ID = "Assignment-Group-Card";
                assignmentGroupCard.TitleText = "Assignment Group";
                assignmentGroupCard.RemoveSubtitleText = true;
                assignmentGroupCard.BodyText = "TWC-SD";
                assignmentGroupCard.RemoveButton2 = true;
                assignmentGroupCard.Button1Text = "Copy";
                assignmentGroupCard.CardAction = "copyByElementID(\"Assignment-Group-Card\")";
                assignmentGroupCard.Create();
            }

            // City of Chicago
            function cityOfChicagoUI() {
                // if the system has multiple UIs, define the current UI
                selectedUI = "City of Chicago";
                // Change the title text
                document.getElementById("toolbarText").innerHTML = "Note Maker - City of Chicago";

                // Remove the previous UI
                button.Remove();
                button2.Remove();
                button3.Remove();
                button4.Remove();
                buttonRow.Remove();

                // Create a menu item
                bitlockerKeyMenuItem = new MenuItem();
                bitlockerKeyMenuItem.MenuItemText = "BitLocker Key";
                bitlockerKeyMenuItem.Icon = "vpn_key";
                bitlockerKeyMenuItem.ItemAction = "loadTemplate(1001)";
                bitlockerKeyMenuItem.Create();
                
                // Create a menu item
                accountUnlockMenuItem = new MenuItem();
                accountUnlockMenuItem.MenuItemText = "Account Unlock";
                accountUnlockMenuItem.Icon = "lock_open";
                accountUnlockMenuItem.ItemAction = "loadTemplate(1002)";
                accountUnlockMenuItem.Create();

                // Create a menu item
                passwordResetMenuItem = new MenuItem();
                passwordResetMenuItem.MenuItemText = "Password Reset";
                passwordResetMenuItem.Icon = "account_circle";
                passwordResetMenuItem.ItemAction = "loadTemplate(1003)";
                passwordResetMenuItem.Create();

                // Create a row
                row1 = new Section();
                row1.SectionID = "Row 1";
                row1.Create();

                // Create a row
                row2 = new Section();
                row2.SectionID = "Row 2";
                row2.Create();

                // Create a row
                row3 = new Section();
                row3.SectionID = "Row 3";
                row3.Create();

                // Create a row
                row4 = new Section();
                row4.SectionID = "Row 4";
                row4.Create();

                // Create a row
                row5 = new Section();
                row5.SectionID = "Row 5";
                row5.Create();

                // Create a text field
                nameField = new TextField();
                nameField.Label = "Name";
                nameField.ID = "Name-Field";
                nameField.ParentID = "Row 1";
                nameField.SpellCheck = false;
                nameField.Required = true;
                nameField.Create();

                // Create a text field
                phoneNumberField = new TextField();
                phoneNumberField.Label = "Phone Number";
                phoneNumberField.ID = "Phone-Number-Field";
                phoneNumberField.ParentID = "Row 1";
                phoneNumberField.SpellCheck = false;
                phoneNumberField.Required = true;
                phoneNumberField.Create();

                // Create a text field
                workHoursField = new TextField();
                workHoursField.Label = "Work Hours";
                workHoursField.ID = "Work-Hours-Field";
                workHoursField.ParentID = "Row 1";
                workHoursField.SpellCheck = false;
                workHoursField.Required = true;
                workHoursField.Create();

                // Create a text field
                chippsIDField = new TextField();
                chippsIDField.Label = "Chipps/Employee ID";
                chippsIDField.ID = "CHIPPS-ID-Field";
                chippsIDField.ParentID = "Row 2";
                chippsIDField.SpellCheck = false;
                chippsIDField.Required = true;
                chippsIDField.Create();

                // Create a text field
                departmentField = new TextField();
                departmentField.Label = "Department";
                departmentField.ID = "Department-Field";
                departmentField.ParentID = "Row 2";
                departmentField.SpellCheck = false;
                departmentField.Required = true;
                departmentField.Create();

                // Create a text field
                formFactorField = new TextField();
                formFactorField.Label = "Desktop/Laptop";
                formFactorField.ID = "Form-Factor-Field";
                formFactorField.ParentID = "Row 2";
                formFactorField.SpellCheck = false;
                formFactorField.Required = true;
                formFactorField.Create();

                // Create a text field
                locationField = new TextField();
                locationField.Label = "Location";
                locationField.ID = "Location-Field";
                locationField.ParentID = "Row 3";
                locationField.SpellCheck = false;
                locationField.Required = true;
                locationField.Create();

                // Create a text field
                problemField = new TextField();
                problemField.Label = "Problem (Symptom)";
                problemField.ID = "Problem-Field";
                problemField.ParentID = "Row 3";
                problemField.AutoComplete = true;
                problemField.Required = true;
                problemField.Create();

                // Create a text field
                actionsField = new TextField();
                actionsField.Label = "Actions";
                actionsField.TextArea = true;
                actionsField.TextAreaColumns = "50";
                actionsField.ID = "Actions-Field";
                actionsField.ParentID = "Row 4";
                actionsField.AutoComplete = true;
                actionsField.Required = true;
                actionsField.Create();

                // Create a text field
                helpFilesField = new TextField();
                helpFilesField.Label = "Help File(s) Used. This should be attached to the ticket within the system.";
                helpFilesField.TextArea = true;
                helpFilesField.ID = "Help-File-Field";
                helpFilesField.ParentID = "Row 4";
                helpFilesField.SpellCheck = false;
                helpFilesField.Required = true;
                helpFilesField.Create();

                // Create a text field
                agentNotesField = new TextField();
                agentNotesField.Label = "Misc. Notes, Will not be saved!";
                agentNotesField.TextArea = true;
                agentNotesField.ID = "Agent-Notes-Field";
                agentNotesField.ParentID = "Row 4";
                agentNotesField.Create();

                // Create a text field
                resolutionField = new TextField();
                resolutionField.Label = "Resolution";
                resolutionField.ID = "Resolution-Field";
                resolutionField.ParentID = "Row 5";
                resolutionField.Required = true;
                resolutionField.Create();

                // Create a text card
                shortDescriptionCard = new TextCard();
                shortDescriptionCard.ID = "Short-Description-Card";
                shortDescriptionCard.TitleText = "(Short) Description";
                shortDescriptionCard.RemoveSubtitleText = true;
                shortDescriptionCard.BodyText = "This content goes in the \"Short Description\" field in SNOW";
                shortDescriptionCard.RemoveButton2 = true;
                shortDescriptionCard.Button1Text = "Copy";
                shortDescriptionCard.CardAction = "copyByElementID(\"Short-Description-Card\", true)";
                shortDescriptionCard.Create();

                // Create a text card
                workNotesCard = new TextCard();
                workNotesCard.ID = "Work-Notes-Card";
                workNotesCard.TitleText = "Work Notes";
                workNotesCard.RemoveSubtitleText = true;
                workNotesCard.BodyText = "This content goes in the \"Work notes\" field in SNOW";
                workNotesCard.RemoveButton2 = true;
                workNotesCard.Button1Text = "Copy";
                workNotesCard.CardAction = "copyByElementID(\"Work-Notes-Card\", true)";
                workNotesCard.Create();

                // Create a text card
                assignmentGroupCard = new TextCard();
                assignmentGroupCard.ID = "Assignment-Group-Card";
                assignmentGroupCard.TitleText = "Assignment Group";
                assignmentGroupCard.RemoveSubtitleText = true;
                assignmentGroupCard.BodyText = "SERVICE DESK-COC";
                assignmentGroupCard.RemoveButton2 = true;
                assignmentGroupCard.Button1Text = "Copy";
                assignmentGroupCard.CardAction = "copyByElementID(\"Assignment-Group-Card\")";
                assignmentGroupCard.Create();
            }

            // A simple function to open the nav drawer
            function openNavDrawer() {
                drawer.open = true;
            }

            // Opens a new browser window/tab with the same url,
            // used to open a new instance of the note maker.
            function newNoteMakerInstance() {
                window.open(window.location.href, "_blank");
            }

            // Display a dialog box that prompts if the user wants to reset the notemaker tool.
            // if yes then run the resetNoteMaker function.
            function resetNoteMakerPrompt() {
                var resetDialog = new MessageBox();
                resetDialog.TitleText = "Reset Notemaker?";
                resetDialog.DescriptionText = "Are you sure that you want to reset the Note Maker?<br><br>You will lose anything that is currently on the screen.";
                resetDialog.OKButtonText = "Reset";
                resetDialog.ListenOK = ["resetNoteMaker", []];
                resetDialog.Show();
            }

            // Opens the same url in the same browser tab. Used to refresh the page and
            // reset the notemaker. When executed, will bypass the safety check for window navigation.
            // Before navigation, submits the form so that autocomplete can pick up the CI field.
            function resetNoteMaker() {
                browserPromptReset = false;
                document.getElementById("Troubleshooting-Input").submit();
                window.open(window.location.href, "_self");
            }

            // Updates the card display for the user to copy the properly formatted text from.
            function updateCards() {
                switch (selectedUI) {
                    case "Init":
                        //pass
                        break;
                    
                    case "Flowserve":
                        var workNotesFormat = "Name: " + nameField.GetText()
                                    + "\n<br>Phone Number: " + phoneNumberField.GetText()
                                    + "\n<br>Work Hours: " + workHoursField.GetText()
                                    + "\n<br>Asset Tag: " + assetTagField.GetText()
                                    + "\n<br>Desktop/Laptop: " + formFactorField.GetText()
                                    + "\n<br>Location: " + locationField.GetText()
                                    + "\n<br>GEMS ID: " + gemsIDField.GetText()
                                    + "\n<br>HF Used: " + helpFilesField.GetText()
                                    + "\n<br>Problem: " + problemField.GetText()
                                    + "\n<br>Actions: " + actionsField.GetText()
                                    + "\n<br>Resolution: " + resolutionField.GetText();
                        shortDescriptionCard.UpdateText(problemField.GetText());
                        workNotesCard.UpdateText(workNotesFormat);
                        break;
                    case "Moët Hennessy":
                        var workNotesFormat = "Name: " + nameField.GetText()
                                    + "\n<br>Phone Number: " + phoneNumberField.GetText()
                                    + "\n<br>Work Hours: " + workHoursField.GetText()
                                    + "\n<br>Desktop/Laptop: " + formFactorField.GetText()
                                    + "\n<br>Location: " + locationField.GetText()
                                    + "\n<br>HF Used: " + helpFilesField.GetText()
                                    + "\n<br>Problem: " + problemField.GetText()
                                    + "\n<br>Actions: " + actionsField.GetText()
                                    + "\n<br>Resolution: " + resolutionField.GetText();
                        shortDescriptionCard.UpdateText(problemField.GetText());
                        workNotesCard.UpdateText(workNotesFormat);
                        break;
                    case "Texas Workforce Commission":
                        var workNotesFormat = "Name: " + nameField.GetText()
                                    + "\n<br>Phone Number: " + phoneNumberField.GetText()
                                    + "\n<br>Work Hours: " + workHoursField.GetText()
                                    + "\n<br>Asset Tag: " + assetTagField.GetText()
                                    + "\n<br>Serial Number: " + serialNumberField.GetText()
                                    + "\n<br>Desktop/Laptop: " + formFactorField.GetText()
                                    + "\n<br>Location: " + locationField.GetText()
                                    + "\n<br>PC Refresh: " + pcRefreshField.GetText()
                                    + "\n<br>HF Used: " + helpFilesField.GetText()
                                    + "\n<br>Problem: " + problemField.GetText()
                                    + "\n<br>Actions: " + actionsField.GetText()
                                    + "\n<br>Resolution: " + resolutionField.GetText();
                        shortDescriptionCard.UpdateText(problemField.GetText());
                        workNotesCard.UpdateText(workNotesFormat);
                        break;
                    case "City of Chicago":
                        var workNotesFormat = "Name: " + nameField.GetText()
                                    + "\n<br>Phone Number: " + phoneNumberField.GetText()
                                    + "\n<br>Work Hours: " + workHoursField.GetText()
                                    + "\n<br>Chipps ID/Employee #: " + chippsIDField.GetText()
                                    + "\n<br>Desktop/Laptop: " + formFactorField.GetText()
                                    + "\n<br>Location: " + locationField.GetText()
                                    + "\n<br>Department: " + departmentField.GetText()
                                    + "\n<br>HF Used: " + helpFilesField.GetText()
                                    + "\n<br>Problem: " + problemField.GetText()
                                    + "\n<br>Actions: " + actionsField.GetText()
                                    + "\n<br>Resolution: " + resolutionField.GetText();
                        shortDescriptionCard.UpdateText(problemField.GetText());
                        workNotesCard.UpdateText(workNotesFormat);
                        break;
                    default:
                        break;
                }
            }

            // Copies the textContent from the specified element identified by its ID.
            // If true is passed as the second item, it will check if the required fields are filled.
            function copyByElementID(ElementID, RequiredToggle) {
                var copyData = document.getElementById(ElementID).textContent;

                // If showDialog true then it will display the copied text dialog box.
                // Before the dialog close command is run, it checks if the dialog is already open just incase the user si working really fast.
                var textCopiedDialog = new MessageBox();

                if (RequiredToggle === true) {
                    var formFields =  document.getElementsByClassName("mdc-textfield__input");
                    var requirementMet = true;

                    for (var index = 0; index < formFields.length; index++) {
                        if (formFields[index].required && formFields[index].value === "") {
                            requirementMet = false;
                        }
                    }
                    if (!requirementMet) {
                        // Build message box that displays the error that info is missing.
                        textCopiedDialog.TitleText = "Missing Info!";
                        textCopiedDialog.DescriptionText = "Please fill out all required fields before copying!";
                        textCopiedDialog.ErrorMode = true;
                        textCopiedDialog.RemoveCancelButton = true;
                        
                    } else {
                        // Copy the text to the clip board.
                        copyText(copyData);

                        // Build message box that indicates that the data has been copied.
                        textCopiedDialog.TitleText = "Text Copied!";
                        textCopiedDialog.DescriptionText = "Your text has been successfully copied to the clipboard :-)";
                        textCopiedDialog.RemoveCancelButton = true;
                        textCopiedDialog.Duration = 1000;
                    }
                } else {
                    // Copy the text to the clip board.
                    copyText(copyData);
                }

                // Show the dialog
                textCopiedDialog.Show();

            }

            // Copies the specified text (given to function via parameter) to the clipboard.
            function copyText(textToCopy) {
                var textArea = document.createElement("textarea");
                textArea.style.position = 'fixed';
                textArea.style.top = 0;
                textArea.style.left = 0;
                textArea.style.width = '2em';
                textArea.style.height = '2em';
                textArea.style.padding = 0;
                textArea.style.border = 'none';
                textArea.style.outline = 'none';
                textArea.style.boxShadow = 'none';
                textArea.style.background = 'transparent';

                textArea.value = textToCopy;

                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
            }

            // Exports the on screen fields as a CSV file.
            function exportCSV() {
                var csvString = fieldValues[0]
                    + "," + fieldValues[1]
                    + "," + fieldValues[2]
                    + "," + fieldValues[3]
                    + "," + fieldValues[4]
                    + "," + fieldValues[5]
                    + "," + fieldValues[6]
                    + "," + fieldValues[7]
                    + "," + fieldValues[8]
                    + "," + fieldValues[9]
                    + "," + fieldValues[10]
                    + "," + fieldValues[11];
                saveTextAsFile(document.getElementById("ticket-number").value + ".csv", csvString);
            }

            // Takes the file name and text to have inputted and downloads that as a file.
            function saveTextAsFile(fileNameToSaveAs, textToWrite) {
                /* Saves a text string as a blob file*/
                var ie = navigator.userAgent.match(/MSIE\s([\d.]+)/),
                    ie11 = navigator.userAgent.match(/Trident\/7.0/) && navigator.userAgent.match(/rv:11/),
                    ieEDGE = navigator.userAgent.match(/Edge/g),
                    ieVer = (ie ? ie[1] : (ie11 ? 11 : (ieEDGE ? 12 : -1)));

                if (ie && ieVer < 10) {
                    console.log("No blobs on IE ver<10");
                    return;
                }

                var textFileAsBlob = new Blob([textToWrite], {
                    type: 'text/plain'
                });

                if (ieVer > -1) {
                    window.navigator.msSaveBlob(textFileAsBlob, fileNameToSaveAs);

                } else {
                    var downloadLink = document.createElement("a");
                    downloadLink.download = fileNameToSaveAs;
                    downloadLink.href = window.URL.createObjectURL(textFileAsBlob);
                    downloadLink.onclick = function (e) { document.body.removeChild(e.target); };
                    downloadLink.style.display = "none";
                    document.body.appendChild(downloadLink);
                    downloadLink.click();
                }
            }

            // Takes the specified input and applies the selected template according to the selection.
            function loadTemplate(TemplateNumber) {
                switch (TemplateNumber) {
                    // template 1
                    case 0001:
                        // pass
                        break;
                    // template 2
                    case 0011:
                        // pass
                        break;
                    // Blank everything (as a fall back)
                    default:
                        var formFields =  document.getElementsByClassName("mdc-textfield__input");
                        for (var index = 0; index < formFields.length; index++) {
                            formFields[index].value = "";
                        }
                        break;
                }
                drawer.open = false;
                updateCards();
                var identifiedTextField = document.getElementsByClassName("mdc-textfield");
                var indexTF;
                for (index = 0; indexTF < identifiedTextField.length; indexTF++) {
                    identifiedTextField[indexTF].className += " mdc-textfield--focused";
                }
                var identifiedLabel = document.getElementsByClassName("mdc-textfield__label");
                var indexL;
                for (indexL = 0; indexL < identifiedLabel.length; indexL++) {
                    identifiedLabel[indexL].className += " mdc-textfield__label--float-above"
                }
            }
        </script>
    </body>
</html>